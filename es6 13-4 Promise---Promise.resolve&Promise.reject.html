<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Promise---Promise.resolve&Promise.reject</title>
</head>

<body>
    <script type="text/javascript">
    function show(arr) {
        console.log("");
        arr.forEach(function(key, i) {
            console.log(i + "", key);
        });
        console.log("");
    }

    /**
     * Promise.resolve()
     */

    // Promise Pending（进行中）、Fulfilled（已成功）和Rejected（已失败）
    // 当Promise状态为fulfilled时，调用 then 的 onfulfilled 方法，当Promise状态为rejected时，调用 then 的 onrejected 方法

    {
        // 直接返回一个Fulfilled状态的Promise
        Promise.resolve('foo');
        // 等价于
        new Promise((resolve, reject) => resolve('foo'));
    }

    /*Promise.resolve方法的参数分成四种情况。*/


    /*（1）参数是一个Promise实例*/
    {
        let p1 = new Promise(function(resolve, reject) {
            // setTimeout(() => reject(new Error('fail')), 3000)
            setTimeout(() => resolve("p1"), 1000)

        });

        // let p2 = new Promise(function(resolve, reject) {
        //     setTimeout(() => resolve(p1), 1000)
        // });

        p1
            .then(null, error => console.log(error))
            .then()
            .then()
            .then()
            .then()
            .then(result => {
                console.log(result, 3);
                console.log(p1 == p1.then());
                console.log(p1);
                console.log(p1.then());
            })
            .then(result => console.log(result, 1), error => console.log(error))
            // .catch(error => console.log(error))
            // Error: fail

        // p1.then(function(value) {
        //   console.log(value); // "成功!"
        //   throw 'oh, no!';
        // }).catch(function(e) {
        //   console.log(e); // "oh, no!"
        // }).then(function(){
        //   console.log('after a catch the chain is restored');
        // }, function () {
        //   console.log('Not fired due to the catch');
        // });

        // // 以下行为与上述相同
        // p1.then(function(value) {
        //   console.log(value); // "成功!"
        //   return Promise.reject('oh, no!');
        // }).catch(function(e) {
        //   console.log(e); // "oh, no!"
        // }).then(function(){
        //   console.log('after a catch the chain is restored');
        // }, function () {
        //   console.log('Not fired due to the catch');
        // });
    }


    // end
    </script>
</body>

</html>
